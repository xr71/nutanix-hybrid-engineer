{"status":{},"contains_secrets":true,"product_version":"3.0.0.1","spec":{"description":"","resources":{"client_attrs":{"7a1406d9_deployment":{"y":289,"x":388}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9a854886_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"306dde4f_runbook","main_task_local_reference":{"kind":"app_task","name":"9a854886_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"56f967a8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9254629a_runbook","main_task_local_reference":{"kind":"app_task","name":"56f967a8_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"9c14e51f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"3b8fe74c_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"c436f6b7_runbook","main_task_local_reference":{"kind":"app_task","name":"9c14e51f_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Stop"}],"name":"bd8007d0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e30de1c4_runbook","main_task_local_reference":{"kind":"app_task","name":"bd8007d0_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"43592afb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3b8fe74c_runbook","main_task_local_reference":{"kind":"app_task","name":"43592afb_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"WebServer","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"WebServerService","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"xxx@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"4a85fe3c-d472-4d21-9cbe-b12e35a7f84d"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccadmin.username}@@\n    ssh-authorized-keys:\n      - @@{teccadmin.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"95cccf9b-03a0-4c00-bf48-b14a7f912cfc","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ce48725f-4a25-4d33-b73a-4037fc74499a"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"teccadmin","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"YpxPhIkfhUqOkbsstT\/d+QvEuCiWO7UeTk6KpON\/3LPFXcZmbWtFjn7vcI0m1V4am1oiL\/PJYgguzDG\/3XVTb\/lUyKJd+AmnXyAeFCJ1V2ymsFa29HW7V6KF5w5lLe+0jCREufdOnQbdVUieDg0STPmNdvQNh\/HA9sBSPLTyx4+itt8+B3ViPc4W7b+UgBeH32H5o48lXV2TZVVSAg+9Dj8F\/khW+bZ2UKgt3jkbNnrwKS7rgArtqj8wmw2pEyaOBBqK6\/Pem+uSjklgleQkuBc3XehRGpeq2W+4JTvnILUFLoHzyhhZb8rAGsDHz8qzLRW95BU+feFnNp8m2maxldx2v22Y6Hai73cVpqNNVFPmjlfvReL0jak75bHHBsZpz73CF711BY+aJ+27FvAy1qeGhhjRR6c70DrmioCaJPXZ3ikOYP1Wb6HuWbKg7cmVKhVSHVHJGwnOxE99A5Yp5m9xKE6a3VX1Mk4PRGn2E8GZHrnqbnpwyu8tzMgEuZj\/UoGRky9hE5ONLIJ+w6K0FgmNJ8iy1JqYsf\/vMHYooA+CNafKlbjrUltiVQH+BWfKelMNYHyZUXiY77vec76ZS07BNP0E3LEAIVJgCPIH3ba8IDBGz9RLtdOKr0D4a3\/S2sFcVWFHFFZsZEvTGi0IOcUWZOduxNcZBovGqG91DSVl6f3LR5IxASHTncMJB09++lTkEDj3rWgl5CHml1Sr3RGL+gerVmxiNSwEmXM0PWt6G7DTeu7SIIGKE4bOjjus55VTqGXuTRUAqWPJq7APqEM7vFmxUxo0L8+JLd0KScnWSVmHz+Z\/oK4nY9YlJy7d4VZwDu9tDhtiD\/Rs5t3Pj\/M7Nb2RFnXXM079X\/+yqPZr4mWgWFAwGvfRmackzj9kX9tj2HmkI3UxYcv4NB+xImZ9J3St4W1ATViLuKI99pbKJBCy1l0pYkD9oOG0nn2uPN43C5cAiY33aw6o1+TApydXoc8JnKtAx7vLqi+qAS7AgzaiEe89uG5fliHMN1p+6nM2gTSW+8zFO70aLb3m7fgvlfG8YqYO5SAF4lpJDMzKXmoP2fJeQvvN9VJVZusSEhEBGv1hlONyEkMMo+cSLnQRNXdTXRgqpV\/5ghDem0A45RwmlengrVtZF2CfFLKVD17LMaIIMkLM3T+35DloKKCNF7mW5wwqGEs55XrwyrLexSx4Ztx2QYOGlsv+UVEAfdBGTvGCx\/NEv7t2lqIBLTHCqv5xjJmOT0urkOS1YpEncf61180pSh6mEdSslcRD0QF88zWdsZs1u85gdRDpDEwB+hWoPpUnBtkqROaouZQ9q0AXrlyi5F8yLBzutQzy1l1wxVMhnEsUfFqKpNj2rzhRW4dL\/CVGCU\/luGd5yg9S0+YmOj6hl+1uhxJi2U4frymcReISc1zmXxwQl0UCc54fKASBYkVeh84mWcGRAUTkPhKXolCd3E\/n8ThproW5TVws5R3bEQq0h+95wnqwaAVh8rB4AMp1CF8Ltd9CT054JFutRA\/gumR2Ns5DZatZ6olhtK5FJ+AYOstVpHnuQ3pV3RBG2DBl9mvC3qqN1JbTFiUz\/6sgTL\/cLLi1\/0BKHYb2v84UBko0fXJK\/USijEEk3VG4ZcoS+wpDQS8DXd4Q2co9bhUTWFRCvbK+doj4kG9Ki+armLmDjW\/DmFl8Y+tvZ9zjlYoWk1t0qS9qoIrJF3vfzrzodoPHF+PEq3uPNAh3bt8ugY9c9yKx8NehGQhCyjcFIDTjwxcUm5itZKci7l6HUciNZMpVrFPtjXC7c23PEDGFwH4Mh6ynL1gxZs60H86mOIX+uXe5uCxAb11lyiz1HbASbrKTOjkyh85FvZMXtBYzBjGJ4mI511ojeWdC8FKvgKVYiEBdZB+VfxTycMDfNyhac6MvqkVvd7xrdO8kz1O\/Ewq+RP3xC7Z6KH3QVYJbNx7u\/cdEiVDPwYBmsnkgAGnApEVtJS39q1H3Yenk0etpBYDpeYa+2zPXqIz2m+XKcNEW0Ltcl5f5mGqLhCEmvmIWXvLLzfLRhhETzETtXkgh908gMx2FDTd6svpFi4T7gIe7FVLs6l0qV7sEKrmV2c2VzK\/G+Ihso5+ppo0yMkpoqWi27mnAUhUhCV7DP\/Kfljs2pJX\/CoxkkrYf87KPMLNYTETP48VWqNOcsXg8bO0AOIxsm0F4y5FCIEyJd3oFuR+xIv05C\/i2akIAf+08+cBNx3V018EGjInVTiCfjwfReP4lmGIEzfebPQqdNllKI0l0xrmuxhN3opulWn8UaGtzmwqZyqGyU1ZaGF4gE0lL8vJDTjYI0HKLElUNJe0uO45DFAckRSnqur3UffWqqiznkm\/VxHgXTGemQCKs\/UsagfzErizFCldJ+t+aNHZeGVdRtmwfS6FgdFKTnrmtxYwavE6Pk0DFRAVWDFz6Budmm4Q2FQBL1cmHZ1cGnP+9NEbjoHa6wF1VVU6e1Hw4QJIJ0QzI0\/tpdzBh+FCYQmadonlItpzjimd7Zg1L0gx3hSjg1vF0Tc+47OGaNAu4JslAQsQlbj5\/4xNWm+3AwlexXOO0rsYhz4Vr\/PQJBf+B+LmMBgkVpxo3vzBswOzoJPbuGXKHWVe+TIdx+IxTW+C9k7mys3xx+FcCajI0m9h9MDum\/P4GvXZxlG7Bino6erggUIz\/xuP4V5g0fqlY2kP9QVzAUejpUDUS82NjynM4bH77IgXarZzPkl8w54awdYVIViNNDwWz0prFiMJ5oirbTO5ryXSZswHfDFCtdk51tg03\/e6L1nE5FbLgRhybT94n68Wm0w39rRXPSd\/yeHfWaqUCAyXOi03uCeE1NfSNv\/W0E+HzQeqhwSPV999E4nYyy3vZPyWDvNLRofd2VpAxIFr3ZBCGqXQbHtCAjGpaXJva\/Mo5mHnAzqCDWZxn0Uy+s\/ZHF\/W9w6xENeGRodjuPcA\/EJkzI8sb2uMh1axhDvrKB6kzFdXLkYyXWanzT4j7WIeiCMDVg7t3NOl06Zf6w4Xr4nZ7ivnhOmpyUCuoI6YwsqMQJZmVHFWqKq9ZqGmLHKXUsPg3KiRe\/mSoxUjCDAdKpTTz\/3EkPBhe+H2SEWgPzJYaq84qnyG8qLeig8uX3rYV47Jwg5Yims1qOJjwFMJ5Va+LC6s0LlpA4cnvoobtCzBvWNSFXPehakZXljnwlVM0cJKdsfL0WQJSqFc3aEJvcaLU8bKnQveDmKZjbLZAfKd5oWyvK9T9QmWQnEq2xFXp1CEumeT10BNVSteXeYapjSD1MWo4NnBzhx77H0WrwO6zu+Y9dB6ewX9LNJnL9gxZnWOLGQMgOErlTwUneOOH9JlnkQwNqI\/I4L+0\/BMNpoiFtWr2FYR9RJBUw59u1VqLuAmZTGZwiGgasFqjxI1eLplJ\/NmyN5A\/MMh2iG8Cdpyk6UBACbtc3J8WyHwClMM6cA33Qrl6aLJ6jYe+al5IEgQAeKYC6ldT4l5pf2LQmNCrtcZpN\/e96sVnTIMkFIEG4K3BbTVUL6E=:utf-8"},"name":"teccadmin"},{"username":"teccdba","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"KnvGT4\/QeG9GskNhTonaVqI2fyIPDI7pOANJuwOK3FaMKq4LkjX7IIXQ8M1axha3H\/24MCelh8Uci5GKY9kXbCtO56GKvY8FqBaABbL1qfxm06ly7CuJX18gvwN9FgrUpvMiUYG+LQ+2Bwe89x2upIlAu8LuCYfrv0gstkVYDD+Wv8CS9dvH05Vw2xlFD6ZxutldsoIXttKboiVWMkjRAB3J1cPAtslIaqCT8n37M\/GgRjgBRXtCGT5NFkvmmklTyan+P0SbfUHkq7uobjvp0ST8hfqeQBn2oglvhMHXU7nDXOtNRZxa4TGmJ9nnrUz5e+bY+iBL+PinK4tkFhPOukHhDtM3SjtyZ5TRU+C+2nQp552jcmqibJjqsoReUY+rnPZitN7sqPuni1hb5zHgeCuufqg7BO25xQTjovVjbPtF2R1rifzDIqMNiY3w\/xtHX86+rpAfx4j9Crz9QNH\/mljRsVluoPpB1QkTr7iq8yHpkSAcBVBMcgDRe4KmzJML1gwS8yXz1RszyHxkKf4wlvFrnS6WLnPoZcqCyUxa\/\/JuCymzQ8OG+P3c9NlnltNe6N105FNoMh88dEL7lFAvHpU9Yr9PRkl2eO\/vaEaVQpPmWMAziO\/ZpYSFZQwSA30lvClBTNiAFOm9qudyDxsCD6OhSZrR0iMeMsV75YpSLMSe9jMfMJrd8QqYz8DndQULTq1XzAmHktwxopnE4X+qt7p4UX4Hqh\/prGgMtgK1NHJ\/dP7JikBMe4gvobNhzn4n2DYUaGyzjuVMjVgf5yf5zFtr2Psv9H2A867\/hFWciUiWRMXqZtyJBABhhVECeOgBuXqBu8gWrOWRAjR1BMBWa2J7t+aPrjPvpqQuesfM7iTF29Ys48NIP06L1Ec6iVXpNObeNEmPKs+aMupi7Tphsmz3IMb4wuiqwbPp6lCZVDUu8Z\/J+SNNd4QJpjpzmgb6+B8uXRtF9Y3fXFWr5XvdasL+GY6HzVlskDnC0lWI6fZLJyvS4csgyZWGBtcAY1yR9jYgAAlV43wA7xQ9nEaZ9+Q7zddDrOM5mHMVqj2IDT28MCtW3GxCYiD2m8C4fMlGGjLN8a\/RKB1Mh2Gq+2+TiYiUhA5d9J8vVhbN94H7vzNYRKHXTrk9tsFyJ0Sy2Uf3WTNQozkSxxL2rZ4DJX3iu6Yz9DEMxnSHQw0GB12pjtf\/+SktURW4Pvetvb2forzibaYq073xiVmprdZLDZDTIVPQVWvLRaJDIz2MpQgnl\/KUpIs78m3DR1\/arvom3Vk7ySxsOaP7T2pJ5pP7IYpCtk9VjBJWCH\/uIjiemjKv3WuypkCUe0vHw9ufkCS9RyACyqj\/vwUNOhqVuiwayG9TD4P3Ef4BY3iPW\/0lIhuxhSvzwHhzlOf4Hkxxa7h+bIafr46+gECRedqMdVV19uHpiitv+HRMUJqY53CMUyq8IfLaBo3IQa0BJhFoRobKvDcywwrA0zSOqBrW\/K+OwYuMigsWDDS54WwB5Ot+W6X2aCpjaglPUipPXsc1v9\/k9UedOWNsCZ9EktplKU63Rl5ak\/1Os+h8NNdH6l+OG7IwEQkvmTbs6UQExGwyW0tgYi3WHL8ywGUhWtk7WWEBHgOeFbzCcl+MpUJJ+0v6ndAHvkURnV+AXTwdeV7v66HNlBisTqKuOqoPgHotoT2325CBSptntJK\/9Ehzv\/8XNxtrOrZ8CVOb1tuzbw\/ziClHjEbsRb9YnHeuZ0ZUICv5Z0PCgFw9k+2FKXceAAULW1Fj9MqNj6KEKpaP3Am\/5Kf2A03ILzcHOZQE7XTMvUDnnVaJDcOQSpulGEJacmrMhqPP081VwaBWglGsKbKD5zSVrmQAG+7b2tHU6i728wJg8qwGZyvEdJvMWAebekC6Cb9eMeC1wB5P\/N7kuQjzpOV6CVr6my\/2WwP1LLVX89cu3vTeCYNYuoHqfnMVUdrfGVyjgXG1TBgkdqoXpET\/zULmlyupF+MlPbt88MmDdvMw7J4HmPQT2V7hiECPSaPJpYNq9pyXouxDPV3rmk9clel5SJOR\/oOfdnj+ycLLw4rQlh0YING0ufWM8Vgp1a8qYMo6q0VkZFS8jT3V470FdR9DUdyQe4I3NMDkZ6ZjmQKLRJuhciORs6q+tkBCYm4ra1uvrv4NsncrEEDEPRqre02TK02CowS9yLTrFWXTxK3rL5+eXAsAhW3NEsSnfJseTh3xx8ChxG5chxzSm9gfdhEkvucyiNRtQe8TVBJ4ieWcKlv80y9d+7SHAqnlQYPVRxroEm0h1msuzwonjjqrCIgvWGXTtFcX1CRZJHqEwJNma1Vh675F9YKX3AcgX3snm61mzUrpAcVa1C2zSPImZM6ObAVvnOOPYy7OOPjmes9CSMqXmOghdozNNKgt05+mMZC7Wkn1fPiG6pvBDV1AlvufiHSznJ+QIviITkymjqel91Qmt6urTLMAbEnxvGAgbvbxRRPCSdtidrf06PoYiH9mF1xF2KNzJJfYaIHfB9EQdPUiCstdIN8FXhC6kphHNmpr+fas32ea\/MsxzPKiyGVI3aKpa49n2JkUqYJueJpffyLjRel\/5JqpR+xZsPwSkK9cUvGd8PXUV2utHATOIJf5ySDy6WxprgaEFlGldPsbP7iwimlJTnGn4AUGR2yNnh\/4IF+xiGE5egb7PnlvwCCBm9hIrbfyDV7wUeyL7HHb7i3AIUKbHc+RKarqvs69+nK4KCNmIPo9rrREs2BeoEF7a3IR7h21shgKpxcbphfRUHk4AvJYMt+4okFQ\/MMLKSQbZe7n5yj2LZF0B62MiKv8\/eXT6\/gm0x0mRbmkAECsAnR9eDiX9+5ba+xmZRIDahyo+ZKzEnE44xb2xKHLPq4CXtWBicFtVb9J1RI0VzkM4b\/VhVQp1\/DGh3YuarJhTlLndZmqt3HVlyOglaQstH82\/hGg5gaxubPSa1GpZXoWP57NotrA71vGeps1FbgGW42V6c+eVlJIYDOKUlxPkt0jEsL4xZhbSp1E\/73215jmzrnkwZKpMeGP2Dt11puYv1zWY63iltU9fE6++BPgSLr1mJUzuNV+vMQCxA60a\/S7xYKBmhR5jCJgu2pR7TYQpp7\/\/stgr8lRp+Ied+VnxwWdXh00Z8RBy5cth082+9v11mWzUNUl50dDL4+jlcMd+uC\/hnittsWICB3Hm\/SjUaRRuROCoNTcjt\/WYLfrNNbRgMX7M7EKB7BARvm4D5TP0IvCVsu7v2kxkFwdywjtxSegoYdYiCk\/RHk4eCjPpYt985qP2BXiYTN2K48Bj77JotNoFqJUnE7ioPm\/kbSU0q7oFmAWtBz73WqgzOHtzMnoalGbLV92Em0SoqVmVR9zk4g11EA01CDL6NrTT03fUcQle+NBL4DgyXMioPdDbDqIwGrQ9xZvuz3Z\/iTtj0ZE3XCngR4T8\/Ql7jPwDJB9CrxIrU3pAYZGdDFtE056Dprc38KOCOLzA6oatrZERxVr9D3qXHP1jZL6frbob2E9vssVvLl+0gg=:utf-8"},"name":"teccdba"}],"package_definition_list":[{"description":"CentOS_8_Cloud","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentOS_8_Cloud","version":"","options":{"type":"","name":"CentOS_8_Cloud","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud.centos.org\/centos\/8\/x86_64\/images\/CentOS-8-GenericCloud-8.2.2004-20200611.2.x86_64.qcow2","version":{"product_version":"8","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Package2","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_Update"},{"kind":"app_task","name":"WebServer_Install"},{"kind":"app_task","name":"WebServer_3Tier"}],"name":"d3664347_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"WebServer_Install"}},{"from_task_reference":{"kind":"app_task","name":"WebServer_Install"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"WebServer_3Tier"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_3Tier","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"69c5d583_runbook","main_task_local_reference":{"kind":"app_task","name":"d3664347_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer"}],"name":"0b9d80b8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"34a7810d_runbook","main_task_local_reference":{"kind":"app_task","name":"0b9d80b8_dag"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"7a1406d9_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerService"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Small","variable_list":[]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"teccadmin"},"type":"USER"},"name":"Web-Application-3-Tier"},"api_version":"3.0","metadata":{"last_update_time":"1613015623830713","kind":"blueprint","spec_version":8,"creation_time":"1613013810486781","name":"Web-Application-3-Tier"}}