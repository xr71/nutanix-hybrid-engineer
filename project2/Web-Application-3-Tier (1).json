{"status":{},"contains_secrets":true,"product_version":"3.0.0.1","spec":{"description":"","resources":{"client_attrs":{"943539f6_deployment":{"y":385.6428571429,"x":139.9308035714},"7a1406d9_deployment":{"y":289,"x":388}},"service_definition_list":[{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"9a854886_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"306dde4f_runbook","main_task_local_reference":{"kind":"app_task","name":"9a854886_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"56f967a8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"9254629a_runbook","main_task_local_reference":{"kind":"app_task","name":"56f967a8_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"9c14e51f_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"3b8fe74c_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"c436f6b7_runbook","main_task_local_reference":{"kind":"app_task","name":"9c14e51f_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Stop"}],"name":"bd8007d0_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"e30de1c4_runbook","main_task_local_reference":{"kind":"app_task","name":"bd8007d0_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"43592afb_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl restart httpd\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"3b8fe74c_runbook","main_task_local_reference":{"kind":"app_task","name":"43592afb_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"WebServer","port_list":[],"tier":"","variable_list":[],"description":""},{"singleton":false,"action_list":[{"description":"System action for creating an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"83f03ac8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"c7b434ed_runbook","main_task_local_reference":{"kind":"app_task","name":"83f03ac8_dag"},"variable_list":[]},"name":"action_create"},{"description":"System action for deleting an application. Deletes created VMs as well","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"63bc7f36_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]}],"description":"","name":"ef822435_runbook","main_task_local_reference":{"kind":"app_task","name":"63bc7f36_dag"},"variable_list":[]},"name":"action_delete"},{"description":"System action for starting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Restart"}],"name":"db3900ca_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Restart","attrs":{"type":"CALL_RUNBOOK","inarg_list":[],"runbook_reference":{"kind":"app_runbook","name":"7b234ec8_runbook"}},"timeout_secs":"0","type":"CALL_RUNBOOK","variable_list":[]}],"description":"","name":"c7ad1103_runbook","main_task_local_reference":{"kind":"app_task","name":"db3900ca_dag"},"variable_list":[]},"name":"action_start"},{"description":"System action for stopping an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Stop"}],"name":"a13da285_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Stop","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl stop haproxy\r\nsudo systemctl daemon-reload\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"6d0b6d98_runbook","main_task_local_reference":{"kind":"app_task","name":"a13da285_dag"},"variable_list":[]},"name":"action_stop"},{"description":"System action for restarting an application","type":"system","critical":false,"runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Restart"}],"name":"2d29da87_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Restart","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo systemctl daemon-reload\r\nsudo systemctl restart haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"7b234ec8_runbook","main_task_local_reference":{"kind":"app_task","name":"2d29da87_dag"},"variable_list":[]},"name":"action_restart"}],"depends_on_list":[],"name":"HAProxy","port_list":[],"tier":"","variable_list":[],"description":""}],"substrate_definition_list":[{"description":"","action_list":[],"type":"AHV_VM","name":"WebServerAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"xxx@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"4a85fe3c-d472-4d21-9cbe-b12e35a7f84d"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccadmin.username}@@\n    ssh-authorized-keys:\n      - @@{teccadmin.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"95cccf9b-03a0-4c00-bf48-b14a7f912cfc","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ce48725f-4a25-4d33-b73a-4037fc74499a"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]},{"description":"","action_list":[],"type":"AHV_VM","name":"HAProxyAHV","readiness_probe":{"connection_type":"SSH","retries":"5","connection_protocol":"","connection_port":22,"address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@","delay_secs":"60","disable_readiness_probe":false,"login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"editables":{"create_spec":{"resources":{"nic_list":{},"serial_port_list":{}}}},"os_type":"Linux","create_spec":{"name":"LoadBalancer-@@{calm_array_index}@@","resources":{"nic_list":[{"nic_type":"NORMAL_NIC","ip_endpoint_list":[],"network_function_chain_reference":null,"network_function_nic_type":"INGRESS","mac_address":"","subnet_reference":{"kind":"subnet","type":"","name":"","uuid":"4a85fe3c-d472-4d21-9cbe-b12e35a7f84d"},"type":""}],"serial_port_list":[],"guest_tools":null,"num_vcpus_per_socket":1,"num_sockets":1,"gpu_list":[],"memory_size_mib":1024,"parent_reference":null,"hardware_clock_timezone":"","guest_customization":{"cloud_init":{"meta_data":"","type":"","user_data":"#cloud-config\nusers:\n  - name: @@{teccadmin.username}@@\n    ssh-authorized-keys:\n      - @@{teccadmin.public_key}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']\n"},"type":"","sysprep":null},"power_state":"ON","type":"","account_uuid":"95cccf9b-03a0-4c00-bf48-b14a7f912cfc","boot_config":{"boot_device":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"}},"type":"","boot_type":"","mac_address":""},"disk_list":[{"data_source_reference":{"kind":"app_package","type":"","name":"CentOS_8_Cloud","uuid":"ce48725f-4a25-4d33-b73a-4037fc74499a"},"type":"","disk_size_mib":0,"volume_group_reference":null,"device_properties":{"type":"","disk_address":{"type":"","device_index":0,"adapter_type":"SCSI"},"device_type":"DISK"}}]},"availability_zone_reference":null,"backup_policy":null,"type":"","cluster_reference":null,"categories":""},"variable_list":[]}],"credential_definition_list":[{"username":"teccadmin","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"fEmIeST4SI7PmOXH\/PUQmgjYDAT5F44O5Vi76rl1YhCU0xiEZuMcywKz3RE3CMUYW4lLRwwwH2bnEc\/wmVP1Fuo8qgy6Zbat21WmU2JpE+JBEsuw7\/+nDMtOQQ3J7xRkXdzkCH3XGbDCwVWVUHQOa5lrU2mDyMUSj4AarTCVqTKEXcZ1dmVGtIkcgBFxhqityPngoTovPgsyT\/bgq1DclGsfFnJPGvYCIsbAYwd6gx6cx0mSccYdgwIn0zLWYGIIoWhCD2teuAZBmVa7XtSf7\/T1scXhIKs8xxWPczSb3OyBQ35dr4srRVOUgES5aDoE55rAYwfZ7ei0VNrA3JwxfYbyiKK3ohQmrYuCAGsH3HYnppPdsJBaPQd2dyAcjOQIRLnkATh4YpWr65xiLYGsWXrdmCudaNJrAjnmQfbPTpgJ4exnG57id98UgdDxJLSZNQF1P\/jfO3zVnWIhMBlzPfQFyFzwA7sdfZjq87hX1sIKkN3Ni0sDueAUo8iJl7bNPMRg59VbPuJMjeqpcnX5\/B4S9aHIW7mhxQWdd\/cb1tiB7wOP43bRumfSxa0l8rQjzS8kAQynheIT6vMzyd4rE46mKkmoPaWCt2LxgekEYziXYPNNbgFZp1VMvxOszPLaczLd7Xa7O3JG9Gfn0a5zjh2rcmfzhM\/LDHm4Zpz+I8NyieqSIt8p8rC06EjuUZ9u7xIPxWsmo3TD29pVPy2Ctv5JeNy+uvU5aBTeVsgI+0CP9kHD0sGANcv9XwE8q\/FTQUIUrJ\/W0E+xpPTy4Rjq1FG0jah9JA6EmI5joq7C6l8aY7h2GDdNoZsX67gEE1BNt1ExJWBH1ykEz4x205mEoDeLzN+gRXAZ0857B6ovXLZgq6j\/EN6jNxf6OhhW8Nzts1yvlV7d3aPAoAHLpp9OIfYhJa4kpGGw8LFFEbB8tpiVaEuJ7EXDiU9HDkwPEGxcuKXyaGsguJ8CT+CZV\/Tdr\/2cEUnlWk2cqd91LQwIoseYSkS\/gOxmCLkvxy+Q8ZDyDV8\/COh1QvaQNbQWyhwQzFSed\/It++NS4rNrys5OR+uN93oPs4dH2L1ZJS4DcVy+y9vuQ0cxGntws+UCJyRg34rqwKGbKF4HiMsTuUEYh7ZSLNTq0kEH2sOODEUn38NLsdl1bGkFv6Qz2Jlae3Z\/6KVdeutt5eNm66PwNyGYkgGz8DP4N\/cNAk8AzRTwlhhZ6Qx7JQvqWPWpjHlkwDdJ+vnucDsqWmcmA5bEjjUCPhOUTzZVZ1zaVC3CWi7FiNRKmaoAJsqhRm5MgxJzsei+ayb4ga7eWeJkPRNFi9Nt2DTCG5O76ibtH4FXl0F3xXz2zyh\/eMaf9QghfOGpZDOj5+1u2vkpt1X4X3L3ylrG9S5LlaFVrePSJpku2uwxwNIGAu5pBGZwVTUkbgK\/ZL4ucbli3wOMDYJXr+\/pH6wDgHx6gfZKWcvgb0sTAyvBKkdsuNpeHvqErkwfvB2XRj6mo4XSIW1sW8bKh3TWgTuTuKz2H9mqr36YpLvR\/2ncFCPQZGHszAw+vLCmraNsbfsuQEF6iWMzsKwGqRHHflC9+r\/7UNHL+X1IsHNdr3Nges4opFEhhNdM5aHzgOhx8dsLU0u7bLFhzW4bpHRw1Gj7qUJA92RiXvMngwE8\/CpJ7Med0c3oJiSInxnn9wd3Kl8GPk7U2HUaMsroul932mnWtMQb1QRmmaOyrOvIaVa4\/8JW3y\/4WDDLUwUom3Dl\/MK8s02eFvb3HeLV9MuCsBp3\/9a93Kn5\/bIQGbeNmKV6cNZciixMbxTbUlf\/b8v3r0NZp9tu5A1\/7QrCZT+UZ4wWE+MTDCXQJGOu2oJ\/jXy99qB\/Qy3Kvr+vG\/+CsCl4NPHtGAUqs5zFm+4bbICxpUZ30e1m3taSvKZqprhk6b3tfHedJNseQn7F3o4J7tpFZPEf7fVVtIUhZJXR9uOdednPHenquHhKcM2DAoQ4mv1b0LhQ5RdVgUXjVNbz5aHkvOUS6aiEGcx3THF+QF3t60SGUVN1WmaXX2uWVcWW+6WN\/MWezp8sHesTcbIwiFcvkJvHJyzMwUS0sdycK+8SI7+5V+8bYtWREFnpflKN6g31XomMEGCjzyxJtAcB+MqAF7FBAjK7cQJugGKI8EBpSzeGK3+p3zDLFB+Cqm8bYyE9WCMLkI20WizFglDRYoQbHzgXYALrHfN46sKOA8zhVunGlH7RPQWWWjhe9AxP3fZa\/Ypik8dv276OH7PECOHiwjFjSJhKbc8UtGmQe1+u+lDCEV4HYT1QERlPOwy1\/OfL7cIuGLW3AA8DK9C6n9rUhbVuvwkSsRUfmHBq0No24lXAEfGxx8X9m6zGZe3F23ks8j9vw5Jd5zd+ipcvnUavNXhtg\/Uv3eAKgaUMpdo7UIlBgG9TO5\/FdcLlZSkR6D9a9oSd2KRtbGxViXx1E1OZkV+yb2dxADPOVzjkcVXhO9HG9mOJfzBfOrmSXHWJnFZo8mwvrwdLKxlIIpzs8byTUZk6YRZt\/psY2tDkQB6xc4wLUxO5sO3mA+QCXVv18G0PhAhAsjhssDvrsCP7GtYNrc12SYWq9ic7Crk\/\/9iGix4yRuqgOiPQ7vcGCJtvTD1C52sw7WUscIB35CPfLwxriZuyGjA7JX1N9Nz8YIbwIGlk5EtympIam6lV53sGnE62WHAbPse1rhi6S4AgVR0JfFxm+1hwsjD3y6hz63ay8vCRvkQIMzikeYsBfJTamTfTgT5B7vttYec3Zb5XU7oEQoUaMfA0s\/8gEigGdK1wjJGxMosbLOUXCrsUNY1I9RDjN\/MMY3CqNlheyPwpAWWVzmK5IWKvH23eympET5l+HxGxDpwWGJ9BhzQiyhBOTA+n094iojP9sqZN2RyvLrDUhbHVmuLeQzQLP2qbb2nAbWRugfT67tsVwmk\/UDY76\/wC+gpYMC\/3knJgVAr+SaFULbms0MkmBBNVy8Js\/3PMnf3AiVieCojZhYkCvQJl8Rm5Evk6SmIgJ91k2xmcTIVpwAAroK93jZ8E7FU0GPvCq5yalLAQm41Mfn8AUmzghjhD7qqSzJ4ETxjMgnVVhcf572OtxEvt0oAcXqQHpbDrDZkbIuCOeJOpm5gi9sxDScxiTC6XtP5fGUf7k+jj2qWwvLFH1CS3fiPVCAR+jc4M87FclhrGunMH5NvPo3okR37yZeHH9liph3OIlxFGJh83o87UsX6LUe4MMcp7cKMaSrg6\/q6FksFqrZr4g+kB9qqTeizSz77wqgGbuGNDYNR9RRSscXLeDlY0Cb+gCkwjkRvl48Pr4KHVGDghnxwS+RhUcRZ0EQ\/KLLqkqkVw0E9Zine5v\/ZZ6lVP52DH9scjyiEd18IVT8ll2Fsnrwv\/R8usVjSMQXheTKnULRJBNC5NzBfkmdCQcaaGMhHBIabaKIHFe8r9Wak6645txiyfit6LEx8XZjVPM\/MG3G0DeQ+G7XMUq+\/OSPT3XnnbKCi8ShYdpzQ6Xxfu5ilzQvv1LEuVc6UI3io=:utf-8"},"name":"teccadmin"},{"username":"teccdba","description":"","type":"KEY","secret":{"attrs":{"is_secret_modified":true,"secret_reference":{}},"value":"GJXt2tFks3W5THDeWUWKNyPReIoD4gjTLbg4d6RAGaZBTYMEPSLPmUB5pTgDCjgIqkKRLxwxVfbNb8W2p0fvOkBO7Kv5bMkDI1ORKoU2XAzKsdajw+QujSbR5\/Fg7BsKRRYM0I85SdPidO2\/Y+ZzvvgXRgD2\/sIPdoEccoT1rfznYyZO1mQluzoskn6caVp7VXCUQCjeNKfqmUuo6CfvNJFi3k7mJoffVab2fET7OUtGKrQ0Py4yIc4ptaoY8EEtDrAbpXXlbNMxS\/qdwjOrW71FBe1XT8zlS5H8mNa55wuTqzMDRoSBrpo+Ei62on8m8HYVrDNzjJpRU4JE4AhDXalokNwM0t\/SNu1n1clWECqvgSy+59LcsqvUk2HZnqnqV\/2amVraljA\/eIq5R4vrrbHEjFJSiKdAnwQU1T\/hldLZCab9GB4iJonVlMnCwJ0Ql34jCkEoYrM2\/MLWY0\/oTsPwEQA4WFfNBHkKI5o84k7yqFZ+aqrMx7eZ\/DLDF3DsaoFJDMG7ykeA+3BuykFbl8k53zxir0vtj+TAwNsg5nS6NVh8+seZ1DT216rpix9K9tLqjh98a17Rrhz3PzSNz0Z5V1eQKvx77UN\/J3Bp0nyZ070hZQZ0UOZYWgZZYrtB8UU\/SXO4pv2MI0SdnXu6mh8uMz0mPKdbzJJzLTJ+tBRFQr1wQuq2TNoZbgu3qnwPdyW0SECIl1Uex6S6Z21ZIp0cPXqdrV+3Lt8zPGA7ZQ91WBuMe0VdBKlhsFPZdFpk8wMwKtBbrfaUpOC7orR7EU4SplVxGxFMEqrso21klt4VIKxg8fLwVEae+rk1rXu3fhyfQaYIfOl8RapCQ8HITMHK7YnBFFWYPRp8PeoG+f7U9QuyOeRiK4vFhXXhjlvjQb9uGG55NV95DadoVZINb9LYWQ6bNwKwyOYYf3q9RywYGytrlebwFwqYn2AXl1QmNq41D2OnAMq0qfEbcoaupwygYVgY4Ms7mNGCvuaV4iKb6dv1+fGwXTWvClJEskb\/YW3RCXpJoiY2fQf4AQkjwN9M4nhwdKwZlf+reGVjdVE6QXjM+NSiCFPtaI6N23TNUgLUdoyLKpdeGIxyoafKvzn7AoDyccPYNOv14JNt1zNHmg0sZE38Qf7AumO3r6pe6xEVqWwuB\/nweRn4SSq5MkdjMtSrJgmTBP6M\/adifyZsN0ogFDa1e1vk1MBSNcEYG5HWenubHho5DrDSoAjJA1\/WnD7kAdjjeRq+ZosKBt15hfckbtJgNK+alXehrFkDgqDsHkbJHVUBZC+Ngce90i4Lz4n8P8udGL7gGYRThlBg4vUVKEvT9OgmQq1kKLot+LpHMG6RK+HUdiK2xI18S6eqmA4Wp4uDKKIgNfTVk43FL8BQFEl0LZJ5JwIF3SUKKVXWIDZ7dhGvJmBdS4WJ3Z1+\/fwNpZ\/ojL0Nm6OxBgzqcyJrS3uRwxIeVVKlyhfgeuM5VoM3Ic\/namzWVj2Gvbbsa9PuMWCV6oDgiCqd07z778dH4f2PkRGcGbKY+egETzT4QuZaJGyY3AKdB0ZoJw0aE74\/EkHwp7fCXR1Dhg78Czbp9MgsHSAll2ayYB49gNDYCAlc9C\/uSIAAx0fHG3CgNBTO7u9NIrrw0twYnT1peo0CIaqZ1Ws1pDuubLkRSedNoOmVU4QCbEYKFdnkNequw5bQNd20PIJ6Ub7Ew9UxvSVOThcVM3964yv7MOxQu6poLNKy\/Lo7D6HDlGz6eGdNwcRr4DJoREwl6jKWEKdG3qd2DkpXh42x2VDYIkTvLtKYEO3woxQH5J3OWqszkXDE96468Bc4ghpSIvqWxAVcRWhEccfcs+NNPHTY8JvIW9j4pThQ5U0bEkiU4GFLEUJ8jZAatvbxzZ+eNGak0F1wXXSIgRn2gUX0Ktz7ahz7VI+2Eek3Fnp33hvTv1UxFG88syYBoDqHeKIaW2rwV1Vi5HA3FYCu2gR3129j7UkrpehRhMIJaVbXL9++vB9pF\/6SzWLNuviZ3yxfaG9bATFTo0G1hnrCmG3zmYMjqjscBIbI34UK+pDmuL1MX4VCPdK1tVMbLAMZpqMVHXrDRMM7F4pbX321LJZmSF5hOPKez8\/R9uCDEq\/JhEpgdudfEXWNYfSqp3kc6xgB1cSL\/ZESjJAOx5ynH6IBUjgNqjVVaUzHB6nX4+JYh0\/bVlcjD3nDHyXsWWnWTvsn01aSvrmi1CC0Jve7K+AJuxIDniAm90p9j++WkLv\/ez3lINSuuOc66AkKb7HjQpqkFIhoadzP8Q6VZ+MH4W\/YhiATUpZC0LDAwndab93Aut37i5\/dzKp9MjIuqlohDinE15fgNhBk6hHPTV5qjkmjWGx7hSzECuyXfIDh1TJ73basWah352fK01sZQtdGQ0cAAsiFX6ySCHCA6+JhBajKCSExUZsNEg0wWf3znYHDeLqROgmgtJSQpF29OV+hy5aPa0cuD7Z9Kx4IZAAb61HY\/NRuJyM0KGFj25IlRnMapARLkmmcBaJ4\/GT5R8DlXSHU67vPcWoAcZrUz7J3I3HDpPIf6AnBLFTywVL1AnBsEHJ+Dm1IxTHENcQcY7blgIzNQjMO9sGg\/L5WDp8E3oBLAV8AsVZgFAAyr\/L+tnEeDb8XU9UHZXr2YpN9h\/J+k0dyjHdYBoLKrxS26s+Gos6iU6nqdnthqPEkfiM9dzU7a4KPiA79dr6k5rdFkCTC3FLgvj0iuB9mlchUvWYJFhJqMOvHDKbyOE\/z6RChi3MSU3ypIlKSyiFBLDDzyS6arwdgTvIrz\/CwPBGU1dbxQTEqQo1MoXFIs2W1b7oUAQJS8avoe8\/4wzSiFuUQLhfetg\/q6s+kQcixefUupvcwRlx+SowR4KCYV251HMaOKgSIpmJakzHU1AfAYSDIWLmkJBn4h\/KKa6cetUzxjwYIN1xtNuwV9s+DSQzF9Cq\/miyvHqjP3PoQuxVE8GeQ0ugJGbbnZU8kdpW1jKPsWEFTVlvASlgUcsFTANP8QHkfFq2m6cmmS1ZyaTzHazchJJNiuJwll0DM7oXqdEbx22oAqsyHxLngZUFF6zMWFCtieU3DcyQpDUCyMeCMlOdMPVSUYtCIC\/iXU0krx1LxSWBLeJGPH4jUK39dx3OkfhQZVGT3l+J\/1+1joxogU81mgM+m\/29CGu\/SGBr+Eogn3QG1ZBg1pCoLJYDQDnuqfN4Pb8ORhmvcnRLVu34aaMcjAXAlfwsQeYoeQrpzRc2dWp\/WSxJGqdWi\/+h74nnvwkjk1wp+Af7luhu+\/tNPz+HkNfxtxcgTAHRyUtHJKKxEg2iTRpJUXec46OMuiAjRM0kxFro37y0DSCtjAAmK\/jJTwnDwO6vHF+LpiFpZTKnCtaI6CyZlW0rzFrMm4U2E3GgHtjD\/+xFqmsXSZ\/JuE3pFJVQes6Y\/zFS\/GeFU7zBH4rtz3gW+vsXBnrKwp9RnkL28Mg8fu54nELW4BXns6eCq\/5BRMOVfY3+TbVXOTIfMVH+j+rhY7tsYjlF52BA=:utf-8"},"name":"teccdba"}],"package_definition_list":[{"description":"CentOS_8_Cloud","action_list":[],"type":"SUBSTRATE_IMAGE","service_local_reference_list":[],"name":"CentOS_8_Cloud","version":"","options":{"type":"","name":"CentOS_8_Cloud","resources":{"image_type":"DISK_IMAGE","checksum":{"checksum_algorithm":"","type":"","checksum_value":""},"source_uri":"https:\/\/cloud.centos.org\/centos\/8\/x86_64\/images\/CentOS-8-GenericCloud-8.2.2004-20200611.2.x86_64.qcow2","version":{"product_version":"8","type":"","product_name":"CentOS"},"architecture":"X86_64","type":""},"description":""},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"WebServer"}],"name":"Package2","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Linux_Update"},{"kind":"app_task","name":"WebServer_Install"},{"kind":"app_task","name":"WebServer_3Tier"}],"name":"d3664347_dag","attrs":{"edges":[{"from_task_reference":{"kind":"app_task","name":"Linux_Update"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"WebServer_Install"}},{"from_task_reference":{"kind":"app_task","name":"WebServer_Install"},"edge_type":"user_defined","type":"","to_task_reference":{"kind":"app_task","name":"WebServer_3Tier"}}],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Linux_Update","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y update\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ Install httpd and php...\"\r\nsudo yum install -y httpd\r\nsudo yum install -y php php-gd php-mbstring php-pdo php-mysqlnd\r\n\r\necho \"<IfModule mod_dir.c>\r\n        DirectoryIndex index.php index.html\r\n<\/IfModule>\" | sudo tee \/etc\/httpd\/conf.modules.d\/dir.conf\r\n\r\necho \"<?php\r\nphpinfo();\r\n?>\" | sudo tee \/var\/www\/html\/index.php\r\n\r\nsudo systemctl enable httpd\r\n\r\n# temporarily disable SELinux to prevent httpd to MySQL authentication issues\r\n# this is for testing only and should not be done in production environments\r\necho \"__ Temporarily disable SELinux...\"\r\nsudo setenforce 0\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"WebServer_3Tier","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\nset -ex\n\nsudo touch \/var\/www\/html\/index.php\nsudo chown @@{teccadmin.username}@@:@@{teccadmin.username}@@ \/var\/www\/html\/index.php\n\ncat > \/var\/www\/html\/index.php <<- \"EOF\"\n<html>\n<head>\n  <title>@@{calm_blueprint_name}@@<\/title>\n<\/head>\n<body>\n <h1>Hostname: @@{name}@@ at @@{address}@@, replica: @@{calm_array_index}@@<\/h1>\n<?php\ntry {\n  $dbh = new PDO('mysql:host=@@{MySQL.address}@@;dbname=@@{DATABASE_NAME}@@', '@@{MYSQL_APP_USER}@@', '@@{MYSQL_PASSWORD}@@', array(\n    PDO::ATTR_PERSISTENT => true,\n    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n  ));\n\n  \/\/ ensure there is at least 1 row of data for the app to read\n  $data = $dbh->query(\"INSERT INTO @@{DATABASE_TABLE}@@ (id, time, message) VALUES (NULL, CURRENT_TIMESTAMP, '@@{calm_username}@@')\");\n\n  $data = $dbh->query('SELECT MAX(id) AS count FROM @@{DATABASE_TABLE}@@')->fetchAll(PDO::FETCH_COLUMN);\n  $count = $data[0]; \/\/print_r($data);\n  $data = $dbh->query(\"SELECT time, message FROM @@{DATABASE_TABLE}@@ WHERE id = $count\")->fetchAll(PDO::FETCH_ASSOC);\n  $time = $data[0]['time'];\n  $message = $data[0]['message'];\n\n  echo \"<p>Database records: $count<\/p>\\n\";\n  echo \"<p>Last maintainer: $message, on: $time<\/p>\\n\";\n  echo \"<h3>Web docroot: {$_SERVER[\"DOCUMENT_ROOT\"]}, file: {$_SERVER[\"SCRIPT_NAME\"]}<\/h3>\\n\";\n\n  $dbh = null;\n}\ncatch (PDOException $e) {\n  print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n  print phpinfo();\n  die();\n}\n?><\/body>\n<\/html>\nEOF\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"69c5d583_runbook","main_task_local_reference":{"kind":"app_task","name":"d3664347_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"Package2"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"Uninstall_WebServer"}],"name":"0b9d80b8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"WebServer"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"Uninstall_WebServer","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\nsudo rm -rf \/var\/www\/html\/* || true\r\nsudo yum erase -y httpd php || true\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"34a7810d_runbook","main_task_local_reference":{"kind":"app_task","name":"0b9d80b8_dag"},"variable_list":[]}},"variable_list":[]},{"description":"","action_list":[],"type":"DEB","service_local_reference_list":[{"kind":"app_service","name":"HAProxy"}],"name":"HAProxy_Install","version":"","options":{"install_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HAProxy_Install"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Install"}],"name":"31a9b881_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Install","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\nset -ex\r\n\r\necho \"__ HAProxy installation...\"\r\nsudo yum install -y haproxy &&\r\n  sudo systemctl enable haproxy || true # idempotent\r\nhaproxy -v\r\n\r\necho \"__ HAProxy configuration...\"\r\n# http:\/\/cbonte.github.io\/haproxy-dconv\/1.8\/configuration.html#4\r\nport=80\r\n\r\necho \"global\r\n  log 127.0.0.1 local0\r\n  log 127.0.0.1 local1 notice\r\n  maxconn 4096\r\n  quiet\r\n  user haproxy\r\n  group haproxy\r\ndefaults\r\n  log global\r\n  mode http\r\n  retries 3\r\n  timeout client 50s\r\n  timeout connect 5s\r\n  timeout server 50s\r\n  option dontlognull\r\n  option httplog\r\n  option redispatch\r\n  balance  roundrobin\r\n# Set up application listeners here.\r\nlisten stats\r\n  bind *:8080\r\n  mode http\r\n  log global\r\n  stats enable\r\n  stats hide-version\r\n  stats refresh 30s\r\n  stats show-node\r\n  stats uri \/stats\r\n#listen admin\r\n#  bind 127.0.0.1:22002\r\n#  mode http\r\n#  stats uri \/\r\nfrontend http\r\n  bind *:${port}\r\n  maxconn 2000\r\n  default_backend servers-http\r\nbackend servers-http\" | sudo tee \/etc\/haproxy\/haproxy.cfg\r\n\r\nsudo sed -i 's\/server host-\/#server host-\/g' \/etc\/haproxy\/haproxy.cfg\r\n\r\nhosts=$(echo \"@@{WebServer.address}@@\" | sed 's\/^,\/\/' | sed 's\/,$\/\/' | tr \",\" \"\\n\")\r\nfor host in $hosts; do\r\n  echo  \"  server host-${host} ${host}:${port} weight 1 maxconn 100 check\" | sudo tee -a \/etc\/haproxy\/haproxy.cfg\r\ndone\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"383b55d3_runbook","main_task_local_reference":{"kind":"app_task","name":"31a9b881_dag"},"variable_list":[]},"type":"","uninstall_runbook":{"task_definition_list":[{"target_any_local_reference":{"kind":"app_package","name":"HAProxy_Install"},"retries":"0","description":"","child_tasks_local_reference_list":[{"kind":"app_task","name":"HAProxy_Uninstall"}],"name":"d1e465f8_dag","attrs":{"edges":[],"type":""},"timeout_secs":"0","type":"DAG","variable_list":[]},{"target_any_local_reference":{"kind":"app_service","name":"HAProxy"},"retries":"0","description":"","child_tasks_local_reference_list":[],"name":"HAProxy_Uninstall","attrs":{"exit_status":[],"script":"#!\/usr\/bin\/env bash\r\n\r\nsudo yum -y erase haproxy\r\n","script_type":"sh","type":"","command_line_args":"","login_credential_local_reference":{"kind":"app_credential","name":"teccadmin"}},"timeout_secs":"0","type":"EXEC","variable_list":[]}],"description":"","name":"bc155a8d_runbook","main_task_local_reference":{"kind":"app_task","name":"d1e465f8_dag"},"variable_list":[]}},"variable_list":[]}],"app_profile_list":[{"deployment_create_list":[{"type":"GREENFIELD","action_list":[],"name":"7a1406d9_deployment","min_replicas":"2","default_replicas":"2","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"4","package_local_reference_list":[{"kind":"app_package","name":"Package2"}],"substrate_local_reference":{"kind":"app_substrate","name":"WebServerAHV"},"variable_list":[],"description":""},{"type":"GREENFIELD","action_list":[],"name":"943539f6_deployment","min_replicas":"1","default_replicas":"1","depends_on_list":[],"published_service_local_reference_list":[],"max_replicas":"1","package_local_reference_list":[{"kind":"app_package","name":"HAProxy_Install"}],"substrate_local_reference":{"kind":"app_substrate","name":"HAProxyAHV"},"variable_list":[],"description":""}],"description":"","action_list":[],"name":"Small","variable_list":[]}],"published_service_definition_list":[],"default_credential_local_reference":{"kind":"app_credential","name":"teccadmin"},"type":"USER"},"name":"Web-Application-3-Tier"},"api_version":"3.0","metadata":{"last_update_time":"1613016646249426","kind":"blueprint","spec_version":15,"creation_time":"1613013810486781","name":"Web-Application-3-Tier"}}